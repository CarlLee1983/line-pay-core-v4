# è²¢ç»åˆ° line-pay-core-v4

æ„Ÿè¬æ‚¨æœ‰èˆˆè¶£ç‚º `line-pay-core-v4` åšå‡ºè²¢ç»ï¼æˆ‘å€‘æ­¡è¿ä¾†è‡ªç¤¾ç¾¤çš„è²¢ç»ã€‚

ç¹é«”ä¸­æ–‡ | [English](./CONTRIBUTING.md)

## ç›®éŒ„

- [è¡Œç‚ºæº–å‰‡](#è¡Œç‚ºæº–å‰‡)
- [å¦‚ä½•è²¢ç»ï¼Ÿ](#å¦‚ä½•è²¢ç»)
- [é–‹ç™¼ç’°å¢ƒè¨­ç½®](#é–‹ç™¼ç’°å¢ƒè¨­ç½®)
- [é–‹ç™¼å·¥ä½œæµç¨‹](#é–‹ç™¼å·¥ä½œæµç¨‹)
- [ç¨‹å¼ç¢¼è¦ç¯„](#ç¨‹å¼ç¢¼è¦ç¯„)
- [æäº¤è¨Šæ¯æŒ‡å—](#æäº¤è¨Šæ¯æŒ‡å—)
- [Pull Request æµç¨‹](#pull-request-æµç¨‹)
- [æ¸¬è©¦](#æ¸¬è©¦)
- [æ–‡ä»¶](#æ–‡ä»¶)

## è¡Œç‚ºæº–å‰‡

æœ¬å°ˆæ¡ˆéµå®ˆè¡Œç‚ºæº–å‰‡ï¼Œæ‰€æœ‰è²¢ç»è€…éƒ½æ‡‰éµå®ˆã€‚è«‹åœ¨æ‰€æœ‰äº’å‹•ä¸­ä¿æŒå°Šé‡å’Œå»ºè¨­æ€§ã€‚

## å¦‚ä½•è²¢ç»ï¼Ÿ

### å›å ±éŒ¯èª¤

åœ¨å»ºç«‹éŒ¯èª¤å›å ±ä¹‹å‰ï¼Œè«‹å…ˆæª¢æŸ¥ç¾æœ‰çš„ issues ä»¥é¿å…é‡è¤‡ã€‚å»ºç«‹éŒ¯èª¤å›å ±æ™‚ï¼Œè«‹åŒ…å«ï¼š

- **æ¸…æ™°çš„æ¨™é¡Œ**ï¼šç°¡è¦æè¿°å•é¡Œ
- **è©³ç´°æè¿°**ï¼šå•é¡Œçš„è©³ç´°èªªæ˜
- **é‡ç¾æ­¥é©Ÿ**ï¼šé€æ­¥èªªæ˜å¦‚ä½•é‡ç¾å•é¡Œ
- **é æœŸè¡Œç‚º**ï¼šæ‚¨é æœŸæœƒç™¼ç”Ÿä»€éº¼
- **å¯¦éš›è¡Œç‚º**ï¼šå¯¦éš›ç™¼ç”Ÿäº†ä»€éº¼
- **ç’°å¢ƒè³‡è¨Š**ï¼šä½œæ¥­ç³»çµ±ã€Node.js/Bun ç‰ˆæœ¬ã€å¥—ä»¶ç‰ˆæœ¬
- **ç¨‹å¼ç¢¼ç¯„ä¾‹**ï¼šå¯é‡ç¾å•é¡Œçš„æœ€å°ç¨‹å¼ç¢¼ï¼ˆå¦‚é©ç”¨ï¼‰

### å»ºè­°æ”¹é€²

æ”¹é€²å»ºè­°æœƒä½œç‚º GitHub issues è¿½è¹¤ã€‚å»ºç«‹æ”¹é€²å»ºè­°æ™‚ï¼š

- **ä½¿ç”¨æ¸…æ™°ä¸”æè¿°æ€§çš„æ¨™é¡Œ**
- **æä¾›è©³ç´°çš„æ”¹é€²æè¿°**
- **èªªæ˜ç‚ºä»€éº¼é€™å€‹æ”¹é€²æœƒæœ‰ç”¨**
- **åˆ—å‡ºæ‚¨è€ƒæ…®éçš„æ›¿ä»£æ–¹æ¡ˆ**

### Pull Requests

æˆ‘å€‘ç©æ¥µæ­¡è¿æ‚¨çš„ pull requestsï¼š

1. Fork å°ˆæ¡ˆä¸¦å¾ `main` å»ºç«‹æ‚¨çš„åˆ†æ”¯
2. å¦‚æœæ‚¨æ–°å¢äº†éœ€è¦æ¸¬è©¦çš„ç¨‹å¼ç¢¼ï¼Œè«‹æ–°å¢æ¸¬è©¦
3. å¦‚æœæ‚¨è®Šæ›´äº† APIï¼Œè«‹æ›´æ–°æ–‡ä»¶
4. ç¢ºä¿æ¸¬è©¦å¥—ä»¶é€šé
5. ç¢ºä¿æ‚¨çš„ç¨‹å¼ç¢¼éµå¾ªç¨‹å¼ç¢¼è¦ç¯„
6. æäº¤ pull request

## é–‹ç™¼ç’°å¢ƒè¨­ç½®

### å…ˆæ±ºæ¢ä»¶

- [Bun](https://bun.sh/) v1.3.4 æˆ–æ›´æ–°ç‰ˆæœ¬
- [Git](https://git-scm.com/)
- ç¨‹å¼ç¢¼ç·¨è¼¯å™¨ï¼ˆæ¨è–¦ä½¿ç”¨ VS Codeï¼‰

### è¨­ç½®æ­¥é©Ÿ

1. **Fork ä¸¦ clone å°ˆæ¡ˆ**

```bash
git clone https://github.com/YOUR_USERNAME/line-pay-core-v4.git
cd line-pay-core-v4
```

2. **å®‰è£ä¾è³´**

```bash
bun install
```

3. **åŸ·è¡Œæ¸¬è©¦ä»¥ç¢ºä¿ä¸€åˆ‡æ­£å¸¸**

```bash
bun test
```

## é–‹ç™¼å·¥ä½œæµç¨‹

### 1. å»ºç«‹åŠŸèƒ½åˆ†æ”¯

```bash
git checkout -b feature/your-feature-name
# æˆ–
git checkout -b fix/your-bug-fix
```

### 2. é€²è¡Œè®Šæ›´

- æ’°å¯«æ¸…æ™°ã€æ˜“è®€çš„ç¨‹å¼ç¢¼
- éµå¾ªç¨‹å¼ç¢¼è¦ç¯„
- ç‚ºæ–°åŠŸèƒ½æ–°å¢æ¸¬è©¦
- æ ¹æ“šéœ€è¦æ›´æ–°æ–‡ä»¶

### 3. æ¸¬è©¦æ‚¨çš„è®Šæ›´

```bash
# åŸ·è¡Œé¡å‹æª¢æŸ¥
bun run typecheck

# åŸ·è¡Œæ¸¬è©¦
bun test

# æ§‹å»ºå°ˆæ¡ˆ
bun run build
```

### 4. æäº¤æ‚¨çš„è®Šæ›´

```bash
git add .
git commit -m "type: description"
```

è«‹åƒé–±[æäº¤è¨Šæ¯æŒ‡å—](#æäº¤è¨Šæ¯æŒ‡å—)äº†è§£æäº¤è¨Šæ¯æ ¼å¼ã€‚

### 5. æ¨é€ä¸¦å»ºç«‹ Pull Request

```bash
git push origin feature/your-feature-name
```

ç„¶å¾Œåœ¨ GitHub ä¸Šå»ºç«‹ Pull Requestã€‚

## ç¨‹å¼ç¢¼è¦ç¯„

### TypeScript

- æ‰€æœ‰åŸå§‹ç¢¼ä½¿ç”¨ TypeScript
- å•Ÿç”¨åš´æ ¼æ¨¡å¼
- é¿å…ä½¿ç”¨ `any` å‹åˆ¥
- ä½¿ç”¨ JSDoc è¨»è§£è¨˜éŒ„å…¬é–‹ API

### ç¨‹å¼ç¢¼é¢¨æ ¼

æˆ‘å€‘ä½¿ç”¨ TypeScript ä¸¦éµå¾ªä»¥ä¸‹æ…£ä¾‹ï¼š

- **ç¸®æ’**ï¼š2 å€‹ç©ºæ ¼ï¼ˆç”± Prettier/Biome è™•ç†ï¼‰
- **åˆ†è™Ÿ**ï¼šä¸éœ€è¦ï¼ˆå°ˆæ¡ˆå·²é…ç½®ï¼‰
- **å¼•è™Ÿ**ï¼šå­—ä¸²ä½¿ç”¨å–®å¼•è™Ÿ
- **å‘½åæ…£ä¾‹**ï¼š
  - `PascalCase` ç”¨æ–¼é¡åˆ¥å’Œå‹åˆ¥
  - `camelCase` ç”¨æ–¼å‡½æ•¸å’Œè®Šæ•¸
  - `UPPER_CASE` ç”¨æ–¼å¸¸æ•¸

### ç¯„ä¾‹

```typescript
/**
 * é©—è­‰ LINE Pay äº¤æ˜“ ID
 * @param transactionId - è¦é©—è­‰çš„äº¤æ˜“ ID
 * @throws {LinePayValidationError} ç•¶æ ¼å¼ç„¡æ•ˆæ™‚
 */
export function validateTransactionId(transactionId: string): void {
  if (!TRANSACTION_ID_REGEX.test(transactionId)) {
    throw new LinePayValidationError(
      `Invalid transactionId format: expected 19-digit number, got "${transactionId}"`
    )
  }
}
```

## æäº¤è¨Šæ¯æŒ‡å—

æˆ‘å€‘éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/) è¦ç¯„ã€‚

### æäº¤è¨Šæ¯æ ¼å¼

```
<é¡å‹>(<ç¯„åœ>): <ä¸»æ—¨>

<å…§å®¹>

<è¨»è…³>
```

### é¡å‹

- **feat**: æ–°åŠŸèƒ½
- **fix**: éŒ¯èª¤ä¿®å¾©
- **docs**: åƒ…æ–‡ä»¶è®Šæ›´
- **style**: ç¨‹å¼ç¢¼é¢¨æ ¼è®Šæ›´ï¼ˆæ ¼å¼åŒ–ã€åˆ†è™Ÿç­‰ï¼‰
- **refactor**: ç¨‹å¼ç¢¼é‡æ§‹ï¼ˆæ—¢ä¸ä¿®å¾©éŒ¯èª¤ä¹Ÿä¸æ–°å¢åŠŸèƒ½ï¼‰
- **perf**: æ•ˆèƒ½æ”¹é€²
- **test**: æ–°å¢æˆ–æ›´æ–°æ¸¬è©¦
- **chore**: æ§‹å»ºéç¨‹æˆ–è¼”åŠ©å·¥å…·çš„è®Šæ›´

### ç¯„ä¾‹

```bash
# æ–°åŠŸèƒ½
git commit -m "feat: æ–°å¢ç°½åé©—è­‰å·¥å…·"

# éŒ¯èª¤ä¿®å¾©
git commit -m "fix: ä¿®æ­£äº¤æ˜“ ID é©—è­‰æ­£è¦è¡¨é”å¼"

# æ–‡ä»¶
git commit -m "docs: æ›´æ–° LinePayUtils çš„ API åƒè€ƒ"

# é‡æ§‹
git commit -m "refactor: æå–ç°½åç”Ÿæˆé‚è¼¯"
```

## Pull Request æµç¨‹

1. **æ›´æ–°æ–‡ä»¶**ï¼šç¢ºä¿ README å’Œ API æ–‡ä»¶å·²æ›´æ–°
2. **æ–°å¢æ¸¬è©¦**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½å¿…é ˆåŒ…å«æ¸¬è©¦
3. **é€šéæ‰€æœ‰æª¢æŸ¥**ï¼šç¢ºä¿é¡å‹æª¢æŸ¥ã€æ¸¬è©¦å’Œæ§‹å»ºéƒ½é€šé
4. **æ¸…ç†æäº¤æ­·å²**ï¼šå¿…è¦æ™‚é€²è¡Œ squash æˆ– rebase
5. **åƒè€ƒ Issues**ï¼šåœ¨ PR æè¿°ä¸­é€£çµç›¸é—œ issues
6. **è«‹æ±‚å¯©æŸ¥**ï¼šæ¨™è¨˜ç¶­è­·è€…é€²è¡Œå¯©æŸ¥

### PR æ¨™é¡Œæ ¼å¼

éµå¾ªèˆ‡æäº¤è¨Šæ¯ç›¸åŒçš„æ ¼å¼ï¼š

```
feat: æ–°å¢è§£æçš„æ–°å·¥å…·å‡½æ•¸
fix: è§£æ±ºæ™‚åºæ”»æ“Šæ¼æ´
docs: æ”¹é€² README ç¯„ä¾‹
```

### PR æè¿°ç¯„æœ¬

```markdown
## æè¿°
è®Šæ›´çš„ç°¡è¦æè¿°

## è®Šæ›´é¡å‹
- [ ] éŒ¯èª¤ä¿®å¾©
- [ ] æ–°åŠŸèƒ½
- [ ] ç ´å£æ€§è®Šæ›´
- [ ] æ–‡ä»¶æ›´æ–°

## æ¸¬è©¦
æè¿°æ‚¨å¦‚ä½•æ¸¬è©¦æ‚¨çš„è®Šæ›´

## æª¢æŸ¥æ¸…å–®
- [ ] ç¨‹å¼ç¢¼éµå¾ªå°ˆæ¡ˆé¢¨æ ¼æŒ‡å—
- [ ] å·²å®Œæˆè‡ªæˆ‘å¯©æŸ¥
- [ ] ç‚ºè¤‡é›œç¨‹å¼ç¢¼æ–°å¢è¨»è§£
- [ ] å·²æ›´æ–°æ–‡ä»¶
- [ ] å·²æ–°å¢/æ›´æ–°æ¸¬è©¦
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] ç„¡ç ´å£æ€§è®Šæ›´ï¼ˆæˆ–å¦‚ä¸å¯é¿å…å‰‡å·²è¨˜éŒ„ï¼‰
```

## æ¸¬è©¦

### æ’°å¯«æ¸¬è©¦

- å°‡æ¸¬è©¦æ”¾åœ¨ `*.test.ts` æª”æ¡ˆä¸­
- ä½¿ç”¨ Bun çš„æ¸¬è©¦åŸ·è¡Œå™¨
- è¿½æ±‚é«˜ç¨‹å¼ç¢¼è¦†è“‹ç‡
- æ¸¬è©¦é‚Šç•Œæƒ…æ³å’ŒéŒ¯èª¤æ¢ä»¶

### æ¸¬è©¦ç¯„ä¾‹

```typescript
import { describe, expect, test } from 'bun:test'
import { LinePayUtils } from './LinePayUtils'

describe('LinePayUtils', () => {
  describe('isValidTransactionId', () => {
    test('æ‡‰è©²ç‚ºæœ‰æ•ˆçš„ 19 ä½æ•¸äº¤æ˜“ ID å›å‚³ true', () => {
      const validId = '1234567890123456789'
      expect(LinePayUtils.isValidTransactionId(validId)).toBe(true)
    })

    test('æ‡‰è©²ç‚ºç„¡æ•ˆçš„äº¤æ˜“ ID å›å‚³ false', () => {
      const invalidId = '123456789012345678' // åªæœ‰ 18 ä½æ•¸
      expect(LinePayUtils.isValidTransactionId(invalidId)).toBe(false)
    })
  })
})
```

### åŸ·è¡Œæ¸¬è©¦

```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
bun test

# ç›£çœ‹æ¨¡å¼åŸ·è¡Œæ¸¬è©¦
bun test --watch

# åŸ·è¡Œç‰¹å®šæ¸¬è©¦æª”æ¡ˆ
bun test src/LinePayUtils.test.ts
```

## æ–‡ä»¶

### README æ›´æ–°

- ä¿æŒ README.mdï¼ˆè‹±æ–‡ï¼‰å’Œ README_ZH.mdï¼ˆç¹é«”ä¸­æ–‡ï¼‰åŒæ­¥
- ç‚ºæ–°åŠŸèƒ½åŒ…å«ç¨‹å¼ç¢¼ç¯„ä¾‹
- æ›´æ–° API åƒè€ƒå€æ®µ

### ç¨‹å¼ç¢¼æ–‡ä»¶

- ç‚ºå…¬é–‹ API ä½¿ç”¨ JSDoc
- è¨˜éŒ„åƒæ•¸ã€å›å‚³å‹åˆ¥å’Œä¾‹å¤–
- åœ¨è¨»è§£ä¸­åŒ…å«ä½¿ç”¨ç¯„ä¾‹

### ç¯„ä¾‹

```typescript
/**
 * ç‚º LINE Pay API è«‹æ±‚ç”Ÿæˆ HMAC-SHA256 ç°½å
 * 
 * @param secret - Channel secret key
 * @param uri - è«‹æ±‚ URI è·¯å¾‘
 * @param body - è«‹æ±‚å…§å®¹ï¼ˆJSON å­—ä¸²ï¼‰
 * @param nonce - æ­¤è«‹æ±‚çš„éš¨æ©Ÿ nonce
 * @param queryString - å¯é¸çš„ query string
 * @returns Base64 ç·¨ç¢¼çš„ HMAC-SHA256 ç°½å
 * 
 * @example
 * ```typescript
 * const signature = generateSignature(
 *   'my-secret',
 *   '/v3/payments/request',
 *   JSON.stringify({ amount: 100 }),
 *   'random-nonce'
 * )
 * ```
 */
export function generateSignature(
  secret: string,
  uri: string,
  body: string,
  nonce: string,
  queryString = ''
): string {
  // å¯¦ä½œ
}
```

## å•é¡Œï¼Ÿ

å¦‚æœæ‚¨å°è²¢ç»æœ‰ä»»ä½•ç–‘å•ï¼Œæ­¡è¿ï¼š

- é–‹å•Ÿ [GitHub Discussion](https://github.com/CarlLee1983/line-pay-core-v4/discussions)
- å»ºç«‹å¸¶æœ‰ "question" æ¨™ç±¤çš„ issue

## æˆæ¬Šæ¢æ¬¾

é€éè²¢ç»ï¼Œæ‚¨åŒæ„æ‚¨çš„è²¢ç»å°‡ä¾æ“š MIT License æˆæ¬Šã€‚

---

æ„Ÿè¬æ‚¨ç‚º `line-pay-core-v4` åšå‡ºè²¢ç»ï¼ğŸ‰
